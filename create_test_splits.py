# -*- coding: utf-8 -*-
"""create_test_splits.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1OIi5qoQLTrzs83PzDRs4IgO8rf_f6hxB

'''
create_test_splits.py

This script creates the exact test splits used for zero-shot evaluation in the thesis.
Author: Khadijatul Kubra Jessica
Date: January 2026
'''
"""

"""
create_test_splits.py

This script creates the exact test splits used for zero-shot evaluation in the thesis.
Author: Khadijatul Kubra Jessica
Date: January 2026
"""

import pandas as pd

# Fixed random seed for full reproducibility
RANDOM_SEED = 42

# Load full datasets
bangla_full = pd.read_csv("bangla_dataset_cleaned.csv")      # columns: text, label
hindi_full = pd.read_csv("hindi_dataset_final.csv")
malayalam_full = pd.read_csv("malayalam_processed.csv")
tamil_full = pd.read_csv("tamil_processed.csv")

# Create stratified random test splits (same sizes as in thesis)
bangla_test = bangla_full.sample(n=2000, random_state=RANDOM_SEED)
hindi_test = hindi_full.sample(n=1500, random_state=RANDOM_SEED)
malayalam_test = malayalam_full.sample(n=1200, random_state=RANDOM_SEED)
tamil_test = tamil_full.sample(n=1300, random_state=RANDOM_SEED)

# Save test sets
bangla_test.to_csv("bangla_test.csv", index=False)
hindi_test.to_csv("hindi_test.csv", index=False)
malayalam_test.to_csv("malayalam_test.csv", index=False)
tamil_test.to_csv("tamil_test.csv", index=False)

print("Test splits created successfully!")
print(f"Bangla test: {len(bangla_test)} samples")
print(f"Hindi test: {len(hindi_test)} samples")
print(f"Malayalam test: {len(malayalam_test)} samples")
print(f"Tamil test: {len(tamil_test)} samples")